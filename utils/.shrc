#!/usr/bin/env bash
#Copyright (C) dirlt

# mac or ubuntu.
MAC=0
kernel=`uname -s`
if [ $kernel"X" = "DarwinX" ]
then
    MAC=1
fi

# basic path.
PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/sbin:$PATH
MANPATH=/usr/local/share/man:/usr/share/man:$MANPATH

# cdh related.
CDH3=0
CDH4_2_0=0
CDH4_3_0=1

if [ $MAC = 1 ]
then
    export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.7.0_17.jdk/Contents/Home/
    export HADOOP_LZO=/Users/dirlt/repo/hadoop-lzo/
    export HADOOP_CLASSPATH=.:$HADOOP_LZO/build/hadoop-lzo-0.4.17-SNAPSHOT.jar
    export JAVA_LIBRARY_PATH=$HADOOP_LZO/build/native/Mac_OS_X-x86_64-64/lib/
else
    export JAVA_HOME=/usr/lib/jvm/java-6-openjdk-amd64/

    if [ $CDH3 = 1 ]
    then
	export HADOOP_HOME=$HOME/utils/hadoop-0.20.2-cdh3u3/
	export HADOOP_CONF_DIR=$HADOOP_HOME/conf
	export HBASE_HOME=$HOME/utils/hbase-0.90.4-cdh3u3/
	export HBASE_CONF_DIR=$HBASE_HOME/conf
	export OOZIE_HOME=$HOME/utils/oozie-2.3.2-cdh3u3/
	export OOZIE_URL="http://localhost:11000/oozie" # default url
	export HIVE_HOME=$HOME/utils/hive-0.7.1-cdh3u3/
    fi

    if [ $CDH4_2_0 = 1 ]
    then
	export HADOOP_HOME=$HOME/utils/hadoop-2.0.0-cdh4.2.0
	export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop/
	export HBASE_HOME=$HOME/utils/hbase-0.94.2-cdh4.2.0/
	export HBASE_CONF_DIR=$HBASE_HOME/conf
	export HIVE_HOME=$HOME/utils/hive-0.10.0-cdh4.2.0/
    fi

    if [ $CDH4_3_0 = 1 ]
    then
	export HADOOP_HOME=$HOME/utils/hadoop-2.0.0-cdh4.3.0
	export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop/
	export HBASE_HOME=$HOME/utils/hbase-0.94.6-cdh4.3.0/
	export HBASE_CONF_DIR=$HBASE_HOME/conf
	export HIVE_HOME=$HOME/utils/hive-0.10.0-cdh4.3.0/
    fi

    export JAVA_LIBRARY_PATH=$HADOOP_HOME/lib/native/Linux-amd64-64:$HADOOP_HOME/lib/native
    export HADOOP_CLASSPATH=.:$HADOOP_HOME/lib/hadoop-lzo-0.4.15.jar

    PATH=$HADOOP_HOME/bin:$PATH
    PATH=$HADOOP_HOME/sbin:$PATH
    PATH=$HBASE_HOME/bin:$PATH
    PATH=$OOZIE_HOME/bin:$PATH
    PATH=$HIVE_HOME/bin:$PATH

fi

# jdk and jvm.
export CLASSPATH=.:./target/classes:./target/dependency:$JAVA_HOME/lib/tools.jar:$JAVA_HOME/lib/dt.jar:$HADOOP_CLASSPATH:$CLASSPATH
export LD_LIBRARY_PATH=.:$JAVA_LIBRARY_PATH:$LD_LIBRARY_PATH
PATH=$JAVA_HOME/bin:$PATH

# texmacs.
PATH=$HOME/utils/TeXmacs-1.0.7-static-gnu-linux/bin:$PATH

# maven.
PATH=$HOME/utils/apache-maven-3.0.4/bin:$PATH
PATH=$HOME/utils/apache-maven-3.2.1/bin:$PATH

# protocol buffers.
PATH=$HOME/utils/protobuf-2.3.0/build/bin:$PATH
PATH=$HOME/utils/protobuf-2.5.0/build/bin:$PATH
PATH=$HOME/utils/protobuf-2.4.1/build/bin:$PATH

# golang
export GOROOT=$HOME/utils/go
export GOPATH=$HOME/go/
PATH=$GOROOT/bin:$PATH

# scala.
export SCALA_HOME=$HOME/utils/scala-2.10.2
PATH=$SCALA_HOME/bin:$PATH

# sbt
export SBT_HOME=$HOME/utils/sbt
PATH=$SBT_HOME/bin:$PATH
export SBT_OPTS="-Dsbt.global.base=$HOME/.sbt -Dsbt.ivy.home=$HOME/.ivy2"

# ccache
PATH=/usr/lib/ccache:$PATH

# export path and manpath.
PATH=$HOME/utils/bin:$PATH
export PATH
export MANPATH

# other settings.
export EDITOR=vim

# git related.
git config --global alias.lg "log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit --"
git config --global color.ui true
git config --global core.autocrlf false
git config --global user.name "dirtysalt"
git config --global user.email "dirtysalt1987@gmail.com"
git config --global alias.co checkout
git config --global alias.br branch
git config --global alias.ci commit
git config --global alias.st status
git config --global alias.unstage 'reset'
git config --global alias.last 'log -1 HEAD'

# alias and function.
alias dstat='dstat -cdlmnpsy'
if [ $MAC = 1 ]
then
    alias chrome='/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --proxy-pac-url="file://$HOME/.proxy.pac"'
else
    alias chrome='google-chrome --proxy-pac-url="file://$HOME/.proxy.pac"'
fi
function pgrep() {
  ps aux | grep $@
}

# private key.
ssh-add ~/.ssh/id_rsa 2>/dev/null
ssh-add ~/.ssh/github 2>/dev/null

# language.
export LANG="en_US.UTF-8"
export LC_ALL="en_US.UTF-8"
# export LANG="zh_CN.UTF-8"
# export LC_ALL="zh_CN.UTF-8"

# galera
#export MYSQL_SRC=$HOME/repo/wsrep-5.6
export MYSQL_SRC=$HOME/repo/wsrep-5.5
export MYSQL_DIR=$MYSQL_SRC/build_release
